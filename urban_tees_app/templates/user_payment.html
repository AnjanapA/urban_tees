{% extends 'user_layout.html' %}
{% load static %}

{% block content %}
<div class="container py-5">
    <h4 class="mb-4">Payment Summary</h4>

    <div class="row bg-white p-4 shadow rounded mb-3">
        {% for order in orders %}
        <div class="col-12 mb-2">
            <p>{{ order.product.name }} ({{ order.size }}) × {{ order.quantity }}</p>
            <p>Price: ₹{{ order.net_amount }} | Discount: ₹{{ order.total_discount }} | Total: ₹{{ order.total_amount }}</p>
        </div>
        {% endfor %}
    </div>

    <div class="row bg-white p-4 shadow rounded mb-3">
        <div class="col-8">
            <h5>Total Amount</h5>
        </div>
        <div class="col-4">
            <h5>₹{{ total_amount }}</h5>
        </div>
    </div>

    <!-- Razorpay payment form -->
    <form id="razorpay-form" method="POST" action="{{ callback_url }}">
        {% csrf_token %}
        <script
            src="https://checkout.razorpay.com/v1/checkout.js"
            data-key="{{ razorpay_merchant_key }}"
            data-amount="{{ total_amount|floatformat:2|floatformat:'0' }}00"
            data-currency="{{ currency }}"
            data-order_id="{{ razorpay_order_id }}"
            data-buttontext="Pay Now"
            data-name="MyShop"
            data-description="Order Payment"
            data-theme.color="#F37254">
        </script>
        <input type="hidden" name="order_ids" value="{% for order in orders %}{{ order.id }},{% endfor %}">
    </form>
</div>
{% endblock %}
